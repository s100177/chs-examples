# 教程 6: 集中式紧急防洪调度

## 1. 场景目标

本教程旨在演示**集中式控制**中最核心和最常见的一种应用：**紧急状态干预**。

我们将构建一个包含水库和下游泄洪闸的简单系统。正常情况下，泄洪闸可能由本地智能体控制以满足灌溉或供水需求。但是，当一个**中央调度智能体**监测到水库水位超过了预设的防洪警戒水位时，它将发布一个高优先级的强制命令，命令泄洪闸完全打开，以确保水库安全。

通过本示例，您将学习到：
- 如何配置一个中央智能体来监控全局状态。
- 中央智能体如何发布指令来覆盖或否决本地智能体的决策。
- 如何构建一个简单的分层控制系统（中央层 vs. 地方层）。

## 2. 系统配置

本场景的配置分为以下几个文件：

- **`components.yml`**: 定义了两个物理组件：
  - `main_reservoir`: 一个大型水库。
  - `flood_gate`: 位于水库下游的泄洪闸。
- **`topology.yml`**: 定义了水流方向：`main_reservoir` -> `flood_gate`。
- **`config.yml`**: 定义了仿真的总时长和时间步长。
- **`agents.yml`**: 定义了系统的“大脑”，包含三个核心智能体：
  - `reservoir_twin_agent`: 一个数字孪生智能体，负责感知 `main_reservoir` 的实时水位，并将其发布到消息总线的主题 `state/reservoir/main` 上。
  - `gate_control_agent`: 一个模拟的本地控制智能体，它订阅 `action/gate/flood` 主题以获取闸门开度指令。在没有中央干预时，它可能会保持一个默认开度。
  - `central_dispatcher`: **本场景的核心**。这是一个中央调度智能体，它订阅 `state/reservoir/main` 主题以监控水位。一旦水位超过其配置中的 `emergency_level`，它就会向 `action/gate/flood` 主题发布一个强制指令（例如，开度 `1.0`，表示完全打开）。

## 3. 预期结果

运行此场景后，在生成的 `output.yml` 结果文件中，您应当能观察到以下行为：
1.  仿真开始时，`main_reservoir` 的水位会因为入流而逐渐上升。
2.  在水位达到 `emergency_level` 之前，`flood_gate` 的开度可能维持在一个较低的水平。
3.  当 `main_reservoir` 的水位**越过** `emergency_level` 的那一刻，`flood_gate` 的开度会立即**跳变**为 `1.0`（完全打开）。
4.  在此之后，即使本地有其他控制逻辑，闸门开度也会被中央指令锁定在 `1.0`，直到水位下降到安全范围以下（在更复杂的场景中可以实现）。

这个清晰的跳变行为，直观地展示了集中式智能体是如何基于全局信息，实现对本地单元的强制干预和分层控制的。
