# 下游用水变化扰动场景配置
# 模拟下游用户用水需求的动态变化

disturbance_scenario:
  name: "Downstream_Demand_Change_Disturbance"
  description: "模拟下游用户用水需求的时空变化和突发事件"
  type: "downstream_demand_change"
  category: "water_demand"
  
  # 扰动参数配置
  parameters:
    # 下游用户配置
    downstream_users:
      urban_water_supply:
        location: "City_A"
        baseline_demand: 150        # 基准需水量150 m³/s
        user_type: "municipal"
        priority_level: "high"
        supply_reliability: 0.98    # 供水可靠性98%
        
      industrial_users:
        location: "Industrial_Zone_B"
        baseline_demand: 80         # 基准需水量80 m³/s
        user_type: "industrial"
        priority_level: "medium"
        supply_reliability: 0.95    # 供水可靠性95%
        
      agricultural_irrigation:
        location: "Irrigation_District_C"
        baseline_demand: 200        # 基准需水量200 m³/s
        user_type: "agricultural"
        priority_level: "low"
        supply_reliability: 0.90    # 供水可靠性90%
        
      ecological_water:
        location: "Wetland_Reserve_D"
        baseline_demand: 30         # 基准需水量30 m³/s
        user_type: "ecological"
        priority_level: "medium"
        supply_reliability: 0.85    # 供水可靠性85%
    
    # 需求变化模式
    demand_variation_patterns:
      # 日常变化模式
      daily_patterns:
        urban_daily_cycle:
          description: "城市用水日周期"
          peak_hours: [7, 8, 19, 20]  # 用水高峰时段
          peak_multiplier: 2.2        # 高峰倍数 (增强从1.4到2.2)
          valley_hours: [2, 3, 4, 5]  # 用水低谷时段
          valley_multiplier: 0.3      # 低谷倍数 (增强从0.6到0.3)
          weekend_adjustment: 0.9     # 周末调整系数
          
        industrial_shift_pattern:
          description: "工业用水班次模式"
          shift_hours: [[6, 14], [14, 22], [22, 6]]  # 三班制
          shift_multipliers: [1.2, 1.0, 0.3]        # 班次倍数
          maintenance_days: ["Sunday"]               # 维护日
          maintenance_multiplier: 0.1               # 维护期倍数
          
        agricultural_irrigation_cycle:
          description: "农业灌溉周期"
          irrigation_periods: [[5, 9], [17, 21]]    # 灌溉时段
          irrigation_multiplier: 2.5               # 灌溉倍数 (增强从1.8到2.5)
          non_irrigation_multiplier: 0.2           # 非灌溉倍数
          crop_growth_adjustment: [0.8, 1.0, 1.2, 1.5, 1.3, 1.0, 0.5] # 作物生长期调整
      
      # 季节性变化模式
      seasonal_patterns:
        urban_seasonal:
          description: "城市用水季节变化"
          monthly_multipliers: [0.9, 0.9, 1.0, 1.1, 1.2, 1.4, 1.5, 1.4, 1.2, 1.1, 1.0, 0.9]
          temperature_correlation: 0.8             # 温度相关性
          holiday_adjustments:
            spring_festival: 0.7                   # 春节期间
            summer_vacation: 1.1                   # 暑假期间
            national_holiday: 0.8                  # 国庆期间
            
        agricultural_seasonal:
          description: "农业用水季节变化"
          growing_season: [3, 4, 5, 6, 7, 8, 9]    # 生长季
          growing_multiplier: 1.5                  # 生长季倍数
          dormant_multiplier: 0.3                  # 休眠期倍数
          drought_response: 2.0                    # 干旱响应倍数
          flood_response: 0.5                      # 洪水响应倍数
          
        industrial_seasonal:
          description: "工业用水季节变化"
          production_cycles:
            high_season: [6, 7, 8, 11, 12]         # 生产旺季
            low_season: [1, 2, 3]                  # 生产淡季
          seasonal_multipliers: [0.8, 1.2]         # 季节倍数
      
      # 随机波动模式
      stochastic_variations:
        short_term_fluctuation:
          description: "短期随机波动"
          noise_type: "gaussian"
          noise_amplitude: 0.4                     # 噪声幅度40% (增强从10%到40%)
          correlation_time: 3600                   # 相关时间1小时
          
        demand_uncertainty:
          description: "需求不确定性"
          uncertainty_range: 0.35                  # 不确定性范围35% (增强从15%到35%)
          confidence_interval: 0.95               # 置信区间95%
          forecast_accuracy: 0.85                  # 预测精度85%
          
        extreme_events:
          description: "极端用水事件"
          event_types:
            water_shortage_panic:
              probability: 0.01                    # 发生概率1%
              demand_multiplier: 3.5               # 需求倍数 (增强从2.5到3.5)
              duration: 7200                       # 持续2小时
            emergency_supply:
              probability: 0.005                   # 发生概率0.5%
              demand_multiplier: 4.5               # 需求倍数 (增强从3.0到4.5)
              duration: 3600                       # 持续1小时
            industrial_accident:
              probability: 0.002                   # 发生概率0.2%
              demand_reduction: 0.8                # 需求减少80%
              duration: 14400                      # 持续4小时
    
    # 需求预测配置
    demand_forecasting:
      enable: true
      forecasting_methods:
        time_series_analysis:
          method: "ARIMA"
          forecast_horizon: 24                     # 预测时长24小时
          update_frequency: 3600                   # 更新频率1小时
          accuracy_target: 0.9                    # 精度目标90%
          
        machine_learning:
          method: "LSTM"
          input_features:
            - "historical_demand"
            - "weather_data"
            - "economic_indicators"
            - "social_events"
          training_period: 8760                    # 训练周期1年
          
        ensemble_forecasting:
          methods: ["ARIMA", "LSTM", "SVR"]
          weight_optimization: true
          uncertainty_quantification: true
      
      forecast_accuracy:
        short_term: 0.95                           # 短期预测精度95%
        medium_term: 0.85                          # 中期预测精度85%
        long_term: 0.75                            # 长期预测精度75%
    
    # 需求响应策略
    demand_response:
      enable: true
      response_mechanisms:
        price_based_response:
          enable: true
          price_elasticity: -0.3                  # 价格弹性-0.3
          peak_pricing_multiplier: 2.0            # 峰时价格倍数
          off_peak_discount: 0.7                  # 谷时价格折扣
          
        incentive_programs:
          water_conservation_rebate: 0.1           # 节水返利10%
          load_shifting_incentive: 0.05            # 负荷转移激励5%
          emergency_curtailment_compensation: 0.2  # 应急限制补偿20%
          
        regulatory_measures:
          water_use_restrictions:
            drought_level_1: 0.9                  # 一级干旱限制90%
            drought_level_2: 0.8                  # 二级干旱限制80%
            drought_level_3: 0.7                  # 三级干旱限制70%
            emergency_restriction: 0.5            # 紧急限制50%
    
    # 供需平衡策略
    supply_demand_balance:
      enable: true
      balancing_mechanisms:
        priority_allocation:
          enable: true
          allocation_rules:
            - "生活用水优先"
            - "工业用水次之"
            - "农业用水再次"
            - "生态用水最后"
          shortage_sharing_ratio: [0.05, 0.15, 0.6, 0.2]  # 缺水分摊比例
          
        flexible_supply:
          enable: true
          backup_sources:
            - "groundwater_wells"
            - "recycled_water"
            - "emergency_reserves"
          activation_thresholds: [0.9, 0.8, 0.7]  # 启用阈值
          
        demand_management:
          enable: true
          management_strategies:
            - "peak_shaving"
            - "load_shifting"
            - "conservation_promotion"
            - "efficiency_improvement"
    
    # 扰动场景配置
    disturbance_scenarios:
      - scenario_id: "urban_peak_demand"
        start_time: 25200                          # 7小时后开始
        duration: 7200                             # 持续2小时
        affected_users: ["urban_water_supply"]
        demand_multiplier: 3.0
        description: "城市用水高峰"
        
      - scenario_id: "agricultural_irrigation_surge"
        start_time: 18000                          # 5小时后开始
        duration: 14400                            # 持续4小时
        affected_users: ["agricultural_irrigation"]
        demand_multiplier: 2.2
        description: "农业灌溉高峰"
        
      - scenario_id: "industrial_emergency_demand"
        start_time: 43200                          # 12小时后开始
        duration: 3600                             # 持续1小时
        affected_users: ["industrial_users"]
        demand_multiplier: 4.0
        description: "工业应急用水"
        
      - scenario_id: "multi_user_peak_overlap"
        start_time: 64800                          # 18小时后开始
        duration: 5400                             # 持续1.5小时
        affected_users: ["urban_water_supply", "industrial_users"]
        demand_multiplier: 2.5
        description: "多用户需求叠加"
  
  # 触发条件
  trigger_conditions:
    start_time: 0                                  # 仿真开始即触发
    duration: 86400                                # 持续24小时
    trigger_type: "scenario_based"
    
  # 性能指标监测
  monitoring:
    metrics:
      - "supply_demand_ratio"
      - "user_satisfaction_index"
      - "water_shortage_duration"
      - "demand_forecast_accuracy"
      - "system_flexibility"
      - "economic_efficiency"
    sampling_interval: 300                         # 采样间隔5分钟
    
  # 预期影响评估
  expected_impact:
    severity: "high"
    affected_components:
      - "供水调度"
      - "水资源分配"
      - "系统压力"
      - "用户满意度"
    impact_description: "下游用水变化将增加供水调度难度，影响水资源优化配置"
    
    # 影响量化分析
    quantitative_impact:
      supply_stress_increase: 0.4                  # 供水压力增加40%
      scheduling_complexity_increase: 0.6          # 调度复杂度增加60%
      user_satisfaction_decrease: 0.15             # 用户满意度下降15%
      economic_loss_ratio: 0.08                   # 经济损失比例8%
      system_resilience_test: 0.7                 # 系统韧性测试70%