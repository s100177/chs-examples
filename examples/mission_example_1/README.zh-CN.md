# 示例 1: 构建一个分层控制系统

本目录中的示例（1.1 至 1.5）循序渐进地展示了如何从零开始，利用不同的智能体（Agent）构建一个完整的分层智能水务控制系统。

## 示例说明

### `example_1_1_physical_model.py`
*   **目标**: 演示纯物理模型（渠池和闸门）的动态行为。
*   **内容**: 在一个手动的仿真循环中，我们初始化一个渠池（`UnifiedCanal(model_type='integral')`）和一个闸门（`Gate`），并观察在给定上游来流和固定闸门开度的情况下，渠池水位如何随时间变化。
*   **核心概念**: 物理对象建模与仿真。

### `example_1_2_physical_io_agent.py`
*   **目标**: 引入“感知-执行”层，将数字世界与物理世界连接。
*   **内容**: 此示例引入了 `PhysicalIOAgent`。该智能体模拟了两个关键功能：
    1.  **感知 (Sensing)**: 像传感器一样，定期“读取”物理世界的状态（例如，渠池水位），并可能带有噪声，然后将数据发布到消息总线。
    2.  **执行 (Acting)**: 像执行器一样，监听来自消息总线的控制指令，并将其转化为对物理对象（例如，闸门）的具体操作。
*   **核心概念**: 感知与执行的抽象，信息物理接口。

### `example_1_3_gate_control_agent.py`
*   **目标**: 实现一个本地自动控制闭环。
*   **内容**: 此示例展示了 `LocalControlAgent`。该智能体内部包含一个控制器（如此处的PID控制器）。它订阅`PhysicalIOAgent`发布的传感器数据，根据设定的目标值（Setpoint）计算出控制偏差，并生成控制指令（例如，新的闸门开度），再发布到消息总线，由`PhysicalIOAgent`接收并执行。
*   **核心概念**: 现地自动控制，反馈控制回路。

### `example_1_4_digital_twin_agent.py`
*   **目标**: 引入“认知”层，创建物理世界的精确数字镜像。
*   **内容**: 此示例介绍了 `DigitalTwinAgent`。它的职责是订阅原始、可能带噪声的传感器数据，并通过内部的算法（如卡尔曼滤波、指数移动平均等）对数据进行处理、融合与平滑，最终发布一个更准确、更可靠的“净化后”状态。这为上层决策提供了高质量的数据基础。
*   **核心概念**: 数字孪生，状态估计，数据融合。

### `example_1_5_central_dispatcher.py`
*   **目标**: 构建顶层“决策”或“调度”层，实现分层控制。
*   **内容**: 此示例展示了 `CentralDispatcherAgent`。该智能体代表了系统的中央大脑或调度中心。它不关心底层的具体控制细节，而是监控系统的高层状态（例如，下游水库的水位），并根据预设的业务逻辑或优化目标，向下层的`LocalControlAgent`发送高层指令（例如，调整PID控制器的目标水位`setpoint`）。
*   **核心概念**: 分层控制，监督控制，集中式调度。

## 如何运行

你可以按顺序依次执行这些Python脚本，来理解整个系统的构建过程：

```bash
python mission/example_1/example_1_1_physical_model.py
python mission/example_1/example_1_2_physical_io_agent.py
# ...以此类推
```
