# Mission Example 5 - 水电站仿真与调度策略

## 概述

这个示例展示了完整的水电站仿真与调度策略系统，包括水轮机建模、泄洪闸门控制、多机组协调、经济调度优化等多个方面。系统支持4种不同的运行方式和4个专业化的仿真场景。

## 仿真特性

- **水轮机建模**: 高精度的水轮机效率和功率特性建模
- **泄洪闸门控制**: 智能化的闸门调度和安全控制
- **多机组协调**: 多个发电机组的协调运行和负荷分配
- **经济调度**: 基于成本效益的优化调度策略
- **电网交互**: 与电网的实时交互和频率调节
- **智能分析**: 预测性维护和性能优化建议

## 目录结构

```
example_5/
├── 01_turbine_gate_simulation/      # 水轮机和泄洪闸仿真
│   ├── components.yml               # 物理组件配置
│   ├── config.yml                   # 仿真参数配置
│   └── universal_config.yml         # 通用配置文件
├── 02_multi_unit_coordination/      # 多机组协调和电网交互
│   ├── agents.yml                   # 智能体配置
│   ├── components.yml               # 物理组件配置
│   ├── config.yml                   # 仿真参数配置
│   └── universal_config.yml         # 通用配置文件
├── 03_economic_dispatch/            # 水轮机经济调度表计算
│   ├── components.yml               # 物理组件配置
│   ├── config.yml                   # 仿真参数配置
│   └── universal_config.yml         # 通用配置文件
├── 04_gate_scheduling/              # 闸门调度表计算
│   ├── components.yml               # 物理组件配置
│   ├── config.yml                   # 仿真参数配置
│   └── universal_config.yml         # 通用配置文件
├── config_5.yml                     # 原始配置文件
├── universal_config_5.yml           # 主目录通用配置文件
├── run_config_5.py                  # 原始运行脚本
├── run_hardcoded.py                 # 硬编码运行脚本
├── run_scenario.py                  # 场景运行脚本
├── run_unified_scenario.py          # 统一场景运行脚本
├── run_universal_config.py          # 通用配置运行脚本
├── README.zh-CN.md                  # 中文说明文档
└── README.md                        # 本文档
```

## 四个仿真场景

### 5.1 水轮机和泄洪闸仿真

**目录**: `01_turbine_gate_simulation/`

**描述**: 基本的水轮机和泄洪闸仿真，包括水力学建模和控制策略。

**主要功能**:
- 水轮机效率建模和功率计算
- 泄洪闸门的开度控制和流量调节
- 前池水位动态仿真
- 尾水位变化对系统的影响分析
- 实时性能监控和数据记录

**仿真参数**:
- 仿真时长: 100步
- 时间步长: 10.0秒
- 初始水深: 15.0米
- 初始入流: 150.0立方米/秒
- 尾水位上升: 2.0米

**输出结果**:
- 水位变化曲线
- 流量变化图表
- 功率输出分析
- 效率特性曲线

### 5.2 多机组协调和电网交互

**目录**: `02_multi_unit_coordination/`

**描述**: 多个水轮机组的协调运行和电网交互仿真。

**主要功能**:
- 多机组协调控制策略
- 电网频率调节和负荷响应
- 负荷分配优化算法
- 故障响应和备用容量管理
- 智能体间的协作和通信

**仿真参数**:
- 仿真时长: 300步
- 时间步长: 10.0秒
- 机组数量: 2台
- 电网频率: 50Hz
- 负荷变化范围: ±20%

**消息主题**:
- `grid/power_target`: 电网功率需求
- `control/turbines`: 机组控制指令
- `grid/events`: 电网事件通知
- `reservoir/inflow`: 水库入流数据

**输出结果**:
- 多机组功率分配图
- 电网交互数据
- 协调控制日志
- 系统稳定性分析

### 5.3 水轮机经济调度表计算

**目录**: `03_economic_dispatch/`

**描述**: 基于经济性的水轮机调度优化计算。

**主要功能**:
- 经济调度优化算法
- 成本效益分析和计算
- 调度表自动生成
- 效率曲线计算和优化
- 市场价格因素考虑

**优化参数**:
- 水轮机数量: 3台
- 功率范围: 0-100MW
- 水头范围: 10-30米
- 电价: 0.1元/kWh
- 水价: 0.05元/立方米

**输出结果**:
- 经济调度表文件
- 成本效益分析报告
- 优化算法收敛曲线
- 效率特性对比图

### 5.4 闸门调度表计算

**目录**: `04_gate_scheduling/`

**描述**: 泄洪闸门的优化调度策略计算。

**主要功能**:
- 闸门调度优化算法
- 安全约束条件验证
- 调度表计算和生成
- 水位控制策略优化
- 风险评估和安全分析

**优化参数**:
- 闸门数量: 2个
- 流量范围: 0-500立方米/秒
- 水头范围: 5-25米
- 安全水位: 25米
- 安全系数: 1.2

**安全规则**:
- 对称开启: 确保闸门同步操作
- 最大开启速率: 0.1/秒
- 洪水阈值: 25.0米

**输出结果**:
- 闸门调度表文件
- 安全约束验证报告
- 水位控制策略图
- 风险评估分析

## 四种运行方式

### 1. 硬编码方式 (run_hardcoded.py)

**特点**: 所有配置直接在Python代码中定义，支持场景选择。

**适用场景**: 
- 快速原型开发和测试
- 学习系统架构
- 调试和验证功能

**运行方法**:
```bash
python run_hardcoded.py
```

**功能特性**:
- 内置4个场景配置
- 交互式场景选择
- 完整的组件和智能体定义
- 实时仿真监控

### 2. 场景方式 (run_scenario.py)

**特点**: 使用传统的多配置文件方式，支持场景参数选择。

**适用场景**:
- 标准的仿真场景运行
- 配置文件分离管理
- 团队协作开发

**运行方法**:
```bash
python run_scenario.py [5.1|5.2|5.3|5.4]
```

**示例**:
```bash
python run_scenario.py 5.2  # 运行多机组协调场景
python run_scenario.py      # 交互式选择场景
```

### 3. 统一场景方式 (run_unified_scenario.py)

**特点**: 使用统一的配置文件格式，简化配置管理。

**适用场景**:
- 简化的配置管理
- 单一配置文件部署
- 配置一致性要求高的场景

**运行方法**:
```bash
python run_unified_scenario.py [5.1|5.2|5.3|5.4]
```

**配置文件**:
- `universal_config_5.yml`: 主目录通用配置
- `*/universal_config.yml`: 各子目录配置

### 4. 通用配置方式 (run_universal_config.py)

**特点**: 使用功能最完整的通用配置文件，包含高级功能。

**适用场景**:
- 生产环境部署
- 完整功能仿真
- 性能监控和分析
- 高级调试和诊断

**运行方法**:
```bash
python run_universal_config.py [5.1|5.2|5.3|5.4]
```

**高级功能**:
- 实时性能监控和分析
- 智能故障检测和恢复
- 预测性维护建议
- 自适应参数调优
- 多维度数据可视化
- 详细的分析报告生成
- 安全审计和合规检查
- 扩展插件支持

## 配置文件说明

### 基本配置文件

#### config.yml
包含基本的仿真参数：
- 时间步长和仿真步数
- 物理参数设置
- 输出配置
- 消息主题定义

#### components.yml
定义物理组件：
- 前池模型参数
- 水轮机特性参数
- 泄洪闸门参数
- 传感器配置

#### agents.yml (仅5.2场景)
定义智能体：
- 调度智能体
- 协调智能体
- 控制智能体

### 通用配置文件

#### universal_config_5.yml
主目录的通用配置文件，包含：
- 完整的仿真配置
- 所有4个场景的参数
- 高级功能设置
- 调试和监控配置

#### universal_config.yml (各子目录)
各场景专用的通用配置文件，针对特定场景优化。

## 输出结果

仿真完成后，会在以下位置生成结果文件：

### 基本输出
- `output/`: 仿真数据输出
- `logs/`: 详细日志文件
- `plots/`: 可视化图表

### 场景专用输出

#### 5.1 水轮机和泄洪闸仿真
- `hydraulics/`: 水力学分析数据
- `control_logs/`: 控制系统日志
- `efficiency/`: 效率分析报告

#### 5.2 多机组协调和电网交互
- `coordination/`: 协调控制日志
- `grid_data/`: 电网交互数据
- `communication/`: 通信分析报告

#### 5.3 水轮机经济调度表计算
- `tables/`: 调度表文件
- `optimization/`: 优化结果
- `algorithm_analysis/`: 算法分析报告

#### 5.4 闸门调度表计算
- `tables/`: 闸门调度表
- `safety_analysis/`: 安全分析报告
- `risk_assessment/`: 风险评估结果

### 高级输出（通用配置方式）
- `analysis/`: 综合分析报告
- `performance/`: 性能监控报告
- `security/`: 安全审计报告
- `diagnostics/`: 系统诊断报告
- `predictions/`: 预测分析结果

## 使用建议

### 场景选择指南

1. **学习和理解**: 从5.1场景开始，逐步了解水电站系统
2. **协调控制**: 使用5.2场景学习多机组协调策略
3. **经济优化**: 使用5.3场景进行经济调度研究
4. **安全控制**: 使用5.4场景研究安全约束和风险管理

### 运行方式选择

1. **初学者**: 硬编码方式，理解系统架构
2. **开发者**: 场景方式，进行日常开发和测试
3. **部署**: 统一场景方式，简化配置管理
4. **生产**: 通用配置方式，获得完整功能

### 性能优化建议

1. **仿真步长**: 根据精度要求调整时间步长
2. **监控频率**: 平衡监控精度和性能开销
3. **数据输出**: 根据需要选择输出数据类型
4. **可视化**: 大规模仿真时可关闭实时可视化

## 故障排除

### 常见问题

1. **导入错误**: 确保在项目根目录下运行脚本
2. **配置文件缺失**: 检查相应的配置文件是否存在
3. **权限问题**: 确保有写入输出目录的权限
4. **内存不足**: 大规模仿真时调整仿真参数

### 调试建议

1. **日志分析**: 查看详细日志文件定位问题
2. **参数验证**: 使用通用配置的验证功能
3. **性能监控**: 使用性能监控功能分析瓶颈
4. **分步调试**: 从简单场景开始逐步增加复杂度

## 扩展开发

### 添加新场景
1. 创建新的子目录
2. 编写配置文件
3. 更新运行脚本的场景列表
4. 实现场景特定的组件和智能体

### 自定义组件
1. 继承基础组件类
2. 实现特定的物理模型
3. 更新组件配置文件
4. 添加相应的测试用例

### 优化算法集成
1. 实现优化算法接口
2. 配置算法参数
3. 集成到调度系统
4. 验证优化效果

## 技术参数

### 系统要求
- Python 3.8+
- CHS-SDK框架
- 内存: 建议4GB以上
- 存储: 建议1GB可用空间

### 性能指标
- 仿真速度: 实时倍数可调
- 精度: 毫秒级时间分辨率
- 扩展性: 支持100+组件
- 并发性: 支持多智能体并行

## 相关文档

- [CHS-SDK 用户指南](../../docs/user_guide.md)
- [水电站建模指南](../../docs/hydropower_modeling.md)
- [智能体开发指南](../../docs/agent_development.md)
- [配置文件参考](../../docs/configuration_reference.md)
- [API 文档](../../docs/api_reference.md)
- [性能优化指南](../../docs/performance_optimization.md)

## 许可证

本示例遵循CHS-SDK的许可证条款。详情请参阅项目根目录的LICENSE文件。