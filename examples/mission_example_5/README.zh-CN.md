# 示例 5: 水电站仿真与调度策略生成

本目录中的示例（5.1 至 5.4）聚焦于水电站的运行，涵盖了从基础物理仿真到离线生成优化调度表的多个方面。

## 示例说明

### `example_5_1_turbine_gate_simulation.py`
*   **目标**: 独立演示单个水轮机和泄洪闸的物理行为，特别是下游水位（顶托）的影响。
*   **内容**: 此脚本使用 `NetworkSolver` 和 `UnifiedCanal` (配置为 `model_type='st_venant'`) 对水工建筑物进行更精细的液压仿真。它分别模拟了水轮机和闸门在下游尾水位动态变化时的流量响应，直观地展示了“顶托”效应对过流能力的影响。
*   **核心概念**: 液压建模，圣维南方程，尾水顶托效应。

### `example_5_2_multi_turbine_grid.py`
*   **目标**: 演示一个多智能体系统如何协调多台水轮机以满足发电目标，并与外部电网进行交互。
*   **内容**: 此脚本构建了一个包含6台水轮机的发电厂的多智能体仿真（MAS）场景。
    1.  `HydropowerControlAgent`: 作为电站的控制核心，接收总的发电功率目标，并决定如何将负荷最优地分配给6台机组。
    2.  `GridCommunicationAgent`: 模拟外部电网，它可以在仿真过程中向电站发送新的指令，例如因电网故障而突然要求降低最大出力。
    该示例展示了控制智能体如何响应这些外部指令，动态调整机组的运行状态。
*   **核心概念**: 多智能体系统（MAS），负荷分配，电网交互，动态响应。

### `example_5_3_compute_turbine_table.py`
*   **目标**: 解决多台非一致性水轮机的“经济调度”问题，并生成可供实时查询的调度表。
*   **内容**: 这是一个**离线优化**脚本，而非实时仿真。它旨在解决一个经典问题：给定一个总发电任务和当前水头，如何将任务分配给多台效率特性不同的水轮机，从而使得总耗水流量最小（即总发电效率最高）。
    *   脚本使用 `scipy.optimize.minimize` 对所有可能的机组组合进行优化计算。
    *   最终生成一个CSV格式的查找表 (`turbine_economic_table.csv`)。控制智能体在实时运行时，只需查询此表即可获得最优的分配策略，避免了复杂的在线计算。
*   **核心概念**: 经济调度，组合优化，非线性规划，查找表（Look-up Table）。

### `example_5_4_compute_gate_table.py`
*   **目标**: 根据预定义的安全操作规程，生成一个多闸门联合操作的调度表。
*   **内容**: 这个脚本同样是一个**离线工具**。它为包含5个泄洪闸的闸群生成操作表。与追求经济效益不同，此脚本的核心是**遵守安全规则**。
    *   规则要求闸门必须按特定的对称顺序（先开中间的，再开两侧的）开启，以保证水工建筑物的结构稳定。
    *   脚本根据这个规则，计算在不同水头和总下泄流量目标下，每个闸门的精确开启高度。
    *   最终生成一个CSV查找表 (`gate_flow_allocation_table.csv`)，供控制智能体查询，以确保操作的安全性。
*   **核心概念**: 安全操作规程（SOP），基于规则的计算，调度表生成。

## 如何运行

- 对于实时仿真示例，可以直接运行Python脚本:
  ```bash
  python mission/example_5/example_5_1_turbine_gate_simulation.py
  python mission/example_5/example_5_2_multi_turbine_grid.py
  ```
- 对于离线计算工具，运行脚本将会在 `mission/data/` 目录下生成相应的CSV文件:
  ```bash
  python mission/example_5/example_5_3_compute_turbine_table.py
  python mission/example_5/example_5_4_compute_gate_table.py
  ```
